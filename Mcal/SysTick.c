/**********************************************************************************************************************
 *  FILE DESCRIPTION
 *  -----------------------------------------------------------------------------------------------------------------*/
/**        \file  SysTick.c
 *        \brief  SysTick Driver
 *
 *      \details  The Driver Provide SysTick Api
 *                
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "Std_Types.h"
#include "Systick.h"
#include "Mcu_Hw.h"
#include "BITMATH.h"

/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/	

/**********************************************************************************************************************
 *  LOCAL DATA 
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/
uint8 ON_Time=0;
uint8 OFF_Time=0;
uint8 OverFlow=0;

/*****************************/



/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/

void SysTick_Init(uint8 Sec)
{
	/*DISABLE COUNTER*/
	CLEAR_BIT_BIT(SYSTICK_STCTRL_R,0);
	
	
	
//	SYSTICK_STRELOAD_R=15999999;

	/*USE SYSTCLK*/
	SET_BIT(SYSTICK_STCTRL_R,2);
	/*ENABLE INTERRUPT*/
	SET_BIT(SYSTICK_STCTRL_R,1);
	

	
	
	
}



void StartTimer(uint8 ON_Time,uint8 OFF_Time,)
{
	TotalSecs=sec;
	
	SYSTICK_STRELOAD_R=15999999;
	
	/*ENABLE COUNTER*/
	SET_BIT(SYSTICK_STCTRL_R,0);
	
}




void SysTick_Handler (void)
{
	//clear flags
	SET_BIT(SYS_CTRL,11);

	
	if(ON_Time>=OverFlow && ON==0)
	{
		LED_ON_callback
	
	OverFlow++;
	ON=1;
	}
	else if(ON_Time>=OverFlow && ON=1)
	{
		OverFlow++;
			
	}
	
	
	
	else
	{
		ON==2;
		OverFlow=0;
		isr_on_callback;
		OFF==0;
	
		
	}
	
	
	if(OFF_Time>=OverFlow && ON==0)
	{
		LED_ON_callback
	
	OverFlow++;
	ON=1;
	}
	else if(ON_Time>=OverFlow && ON=1)
	{
		OverFlow++;
			
	}
	
	
	
	else{
		ON==2;
		OverFlow=0;
		isr_on_callback;
		OFF==0;
	
		
	}	
	
	
	
		
	
	
	
}








/**********************************************************************************************************************
 *  END OF FILE: SysTick.c
 *********************************************************************************************************************/
